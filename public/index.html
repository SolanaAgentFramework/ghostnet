<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solana Privacy Transfer | Dark Web Protocol</title>
    
    <!-- Signal Jammer Meta Data Pack - Social Camouflage -->
    <meta name="description" content="PROTOCOL: ENCRYPTED // STATUS: ACTIVE. Zero-trace Solana routing architecture.">
    <meta name="theme-color" content="#00f3ff">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="DEAD_DROP // ACCESS_POINT">
    <meta name="twitter:description" content="> ESTABLISHING SECURE CONNECTION...&#10;> GHOST SHARDS: ACTIVE&#10;> LOGS: PURGED">
    <meta name="twitter:image" content="https://solanaagentframework.github.io/dead_drop/og-image.png">
    
    <!-- Open Graph (Facebook, Discord, Telegram, etc.) -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="SOLANA PRIVACY [CLASSIFIED]">
    <meta property="og:description" content="Next-generation anonymity protocol. Mixing pools and ghost routing active.">
    <meta property="og:url" content="https://solanaagentframework.github.io/dead_drop/">
    <meta property="og:site_name" content="DEAD_DROP">
    <meta property="og:image" content="https://solanaagentframework.github.io/dead_drop/og-image.png">
    
    <link rel="stylesheet" href="/styles.css">
    <script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
    <!-- config.js is now merged into app.js (obfuscated) -->
</head>
<body>

    <div class="cyber-world">
        <div class="cyber-floor"></div>
    </div>
    <div class="rain"></div>

    <div class="layout-container">

        <!-- LEFT WALL: Use Cases -->
        <div class="alley-side left-wall">
            <div class="neon-sign sign-cyan">
                GHOST SHARDING
                <span class="sign-sub">Packet Fragmentation</span>
            </div>
            <div class="neon-sign sign-pink">
                NO LOGS
                <span class="sign-sub">Zero-Trace Server</span>
            </div>
            <div class="neon-sign sign-cyan">
                RPC ROTATION
                <span class="sign-sub">IP Masking Active</span>
            </div>
        </div>

        <!-- CENTER TERMINAL: Main App -->
        <div class="main-terminal">
            <header>
                <h1>SOLANA PRIVACY</h1>
                <div class="subtitle">Next-Gen Anonymity Protocol</div>
            </header>

            <!-- Devnet Warning Banner -->
            <div class="card warning-banner" style="margin-bottom: 25px;">
                <h2>‚ö†Ô∏è DEVNET TEST PAGE ‚ö†Ô∏è</h2>
                <p style="color: #ffaa00; font-size: 1.1em; margin: 10px 0;">
                    üö∞ FAUCET GIVES <strong>DEVNET SOL ONLY</strong> üö∞
                </p>
                <p style="color: #aaa; font-size: 0.9em; margin-top: 10px;">
                    This is a testing environment. All transactions are on Solana Devnet.
                </p>
                <p style="margin-top: 15px;">
                    <a href="/tutorial.html" style="color: var(--neon-cyan);">
                        üìö Don't know how to switch Phantom to Devnet? Click here for tutorial! üé•
                    </a>
                </p>
            </div>

            <!-- Wallet Connection Section -->
            <div class="card">
                <h2>WALLET CONNECTION</h2>
                <button id="connectWallet" class="btn btn-primary">
                    INITIALIZE CONNECTION
                </button>
                <div id="walletInfo" class="wallet-info hidden">
                    <p><strong>STATUS:</strong> <span style="color:var(--neon-cyan)">CONNECTED</span></p>
                    <p><strong>ID:</strong> <span id="walletAddress" style="font-family:monospace">...</span></p>
                    <p><strong>BALANCE:</strong> <span id="walletBalance">0 SOL</span></p>
                    <button id="disconnectWallet" class="btn btn-danger">
                        DISCONNECT
                    </button>
                </div>
            </div>

            <!-- Transfer Form -->
            <div class="card">
                <h2>ANONYMOUS TRANSFER</h2>
                <form id="transferForm">
                    <div class="form-group">
                        <label for="destinationAddress">TARGET DESTINATION</label>
                        <input 
                            type="text" 
                            id="destinationAddress" 
                            placeholder="Enter Solana Address"
                            autocomplete="off"
                            required
                        >
                    </div>
                    <div class="form-group">
                        <label for="amount">AMOUNT (SOL)</label>
                        <input 
                            type="number" 
                            id="amount" 
                            step="0.000000001"
                            min="0.003"
                            placeholder="0.003 (minimum)"
                            required
                        >
                        <small>Minimum: 0.003 SOL to cover service costs</small>
                    </div>
                    <div class="fee-info">
                        <p>SERVICE FEE (0.35%): <span id="serviceFee">0.00 SOL</span></p>
                        <p style="font-size: 1.2em; color: #fff;">TOTAL REQUIRED: <span id="totalAmount">0.00 SOL</span></p>
                    </div>
                    <button type="submit" id="sendButton" class="btn btn-success" disabled>
                        EXECUTE ANONYMOUS TRANSFER
                    </button>
                </form>
            </div>

            <!-- Devnet Faucet Section -->
            <div class="card faucet-container">
                <h2>üö∞ DEVNET FAUCET</h2>
                <p style="color: #aaa; margin-bottom: 15px;">
                    Get 0.02 DEVNET SOL for testing (Rate limit: 1 hour per IP/wallet)
                    <br>
                    <a href="/tutorial.html" style="color: var(--neon-cyan); font-size: 0.9em;">
                        üìñ New to Devnet? Read the tutorial
                    </a>
                </p>
                
                <div id="faucetWalletInfo" class="wallet-info hidden" style="margin-bottom: 20px;">
                    <p style="margin: 5px 0;"><strong>Connected Wallet:</strong> <span id="faucetWalletAddress" style="color: var(--neon-yellow); font-family: monospace;"></span></p>
                </div>
                
                <div id="faucetNotConnected" style="padding: 15px; background: rgba(255, 0, 85, 0.1); border: 1px solid #ff0055; border-radius: 2px; margin-bottom: 15px;">
                    <p style="color: #ff0055; margin: 0;">
                        ‚ö†Ô∏è Connect your Phantom wallet first to use the faucet!
                    </p>
                </div>
                
                <button id="faucetButton" onclick="requestAirdrop()" class="btn btn-success" style="width: 100%; font-size: 1.2em; font-weight: bold;" disabled>
                    üéÅ GIMME 0.02 DEVNET SOL üéÅ
                </button>
                <p id="faucetStatus" style="color: var(--neon-yellow); margin-top: 15px; font-size: 0.9em; min-height: 20px;"></p>
            </div>

            <!-- Privacy Animation Section -->
            <div class="card hidden" id="animationCard" style="margin-top: 30px; text-align: center;">
                <h2>PRIVACY PROCESSING</h2>
                <div id="stage1" class="stage-text">INITIALIZING NODES...</div>
                <div id="progressBar" style="width: 0%; height: 5px; background: var(--neon-yellow); margin-top: 10px;"></div>
                <div id="txHash" style="margin-top: 20px; color: var(--neon-cyan); word-break: break-all;"></div>
                
                <!-- Additional animation stages (preserved for app.js compatibility) -->
                <div class="hidden" id="stage2"></div>
                <div class="hidden" id="stage3"></div>
                <div class="hidden" id="stage4"></div>
                <div class="hidden" id="stage5"></div>
                <div class="hidden" id="stage6"></div>
                <div class="hidden" id="stage7"></div>
                <div class="hidden" id="stage8"></div>
            </div>

            <!-- Classified Protocol Timeline -->
            <div class="card" style="margin-top: 40px;">
                <h2>PROTOCOL_TIMELINE</h2>
                <div style="background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 2px solid var(--neon-cyan);">
                    <p style="color: var(--neon-cyan); font-size: 14px; margin: 0; text-align: center;">
                        ‚ö†Ô∏è This GitHub page is a proof of concept demonstration
                    </p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div style="background: rgba(0, 0, 0, 0.6); border: 1px solid var(--neon-cyan); padding: 20px;">
                        <h3 style="color: var(--neon-cyan); margin-bottom: 10px;">PHASE I: GENESIS</h3>
                        <p>‚Ä¢ Ghost Shard Routing [ACTIVE]</p>
                        <p>‚Ä¢ Black Mirror Wallet Integration</p>
                        <p>‚Ä¢ Merkle Verification Layer</p>
                        <div style="margin-top:10px; color: var(--neon-cyan); font-size: 0.8em;">STATUS: DEPLOYED</div>
                    </div>
                    <div style="background: rgba(0, 0, 0, 0.6); border: 1px solid #333; padding: 20px; opacity: 0.7; position: relative;">
                        <div style="position: absolute; top: 10px; right: 10px; font-size: 1.2em; color: #555;">üîí</div>
                        <h3 style="color: #555; margin-bottom: 10px;">PHASE II: [ENCRYPTED]</h3>
                        <div style="background: #222; height: 1em; width: 80%; margin-bottom: 5px; border-radius: 2px;"></div>
                        <div style="background: #222; height: 1em; width: 60%; margin-bottom: 5px; border-radius: 2px;"></div>
                        <div style="background: #222; height: 1em; width: 90%; margin-bottom: 5px; border-radius: 2px;"></div>
                        <div style="margin-top:10px; color: #555; font-size: 0.8em;">STATUS: PENDING DECRYPTION</div>
                    </div>
                    <div style="background: rgba(0, 0, 0, 0.6); border: 1px solid #333; padding: 20px; opacity: 0.7; position: relative;">
                        <div style="position: absolute; top: 10px; right: 10px; font-size: 1.2em; color: #555;">üîí</div>
                        <h3 style="color: #555; margin-bottom: 10px;">PHASE III: [NO SIGNAL]</h3>
                        <div style="background: #222; height: 1em; width: 50%; margin-bottom: 5px; border-radius: 2px;"></div>
                        <div style="background: #222; height: 1em; width: 100%; margin-bottom: 5px; border-radius: 2px;"></div>
                        <div style="background: #222; height: 1em; width: 70%; margin-bottom: 5px; border-radius: 2px;"></div>
                        <div style="margin-top:10px; color: #555; font-size: 0.8em;">STATUS: CLASSIFIED</div>
                    </div>
                </div>
                
                <div style="margin-top: 30px; padding: 15px; background: rgba(0,255,0,0.05); border-radius: 8px; border-left: 4px solid var(--neon-cyan);">
                    <p style="margin: 0; color: var(--neon-cyan); font-size: 14px;">
                        <strong>CLASSIFIED:</strong> Advanced protocols require clearance level 5+. Mathematical proofs of anonymity. Unkillable infrastructure. Zero-knowledge cryptography.
                    </p>
                </div>
            </div>

            <div style="margin-top: 40px; text-align: center; color: #555; font-size: 0.8em;">
                ‚ö† PROOF OF CONCEPT // GITHUB PAGES DEPLOYMENT
            </div>
        </div>

        <!-- RIGHT WALL: Use Cases -->
        <div class="alley-side right-wall">
            <div class="neon-sign sign-yellow">
                MIXING POOL
                <span class="sign-sub">High-Entropy Routing</span>
            </div>
            <div class="neon-sign sign-pink">
                BLACK MIRROR
                <span class="sign-sub">Dual-Vault System</span>
            </div>
            <div class="neon-sign sign-yellow">
                ANTI-MEV
                <span class="sign-sub">Sandwich Protection</span>
            </div>
        </div>

    </div>

    <script src="/app.js"></script>
    <script>
        // Faucet function - uses connected wallet
        async function requestAirdrop() {
            const status = document.getElementById('faucetStatus');
            
            // Get connected wallet address from global variable
            if (typeof walletPublicKey === 'undefined' || !walletPublicKey) {
                status.innerText = "‚ùå Please connect your Phantom wallet first!";
                status.style.color = "#ff0055";
                return;
            }
            
            const address = walletPublicKey.toString();

            status.innerText = "‚è≥ Requesting 0.02 DEVNET SOL...";
            status.style.color = "var(--neon-cyan)";

            try {
                const apiUrl = CONFIG.API_URL || 'http://localhost:3000';
                const response = await fetch(`${apiUrl}/api/request-airdrop`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ walletAddress: address })
                });

                const data = await response.json();

                if (data.success) {
                    status.innerHTML = `‚úÖ Sent! <a href="${data.solscan}" target="_blank" style="color: var(--neon-yellow); text-decoration: underline;">View TX on Solscan</a>`;
                    status.style.color = "var(--neon-yellow)";
                } else {
                    status.innerText = `‚ùå ${data.error || 'Unknown error'}`;
                    status.style.color = "#ff0055";
                }
            } catch (e) {
                status.innerText = "‚ùå Server error. Is the backend running?";
                status.style.color = "#ff0055";
                console.error('Faucet error:', e);
            }
        }

        // Update faucet UI when wallet connects/disconnects
        function updateFaucetUI() {
            const faucetWalletInfo = document.getElementById('faucetWalletInfo');
            const faucetNotConnected = document.getElementById('faucetNotConnected');
            const faucetButton = document.getElementById('faucetButton');
            const faucetWalletAddress = document.getElementById('faucetWalletAddress');
            
            if (typeof walletPublicKey !== 'undefined' && walletPublicKey) {
                // Wallet connected
                faucetWalletInfo.classList.remove('hidden');
                faucetNotConnected.style.display = 'none';
                faucetButton.disabled = false;
                const addr = walletPublicKey.toString();
                faucetWalletAddress.textContent = `${addr.slice(0, 8)}...${addr.slice(-8)}`;
            } else {
                // Wallet not connected
                faucetWalletInfo.classList.add('hidden');
                faucetNotConnected.style.display = 'block';
                faucetButton.disabled = true;
            }
        }

        // Monitor wallet connection changes
        document.addEventListener('DOMContentLoaded', () => {
            // Check wallet connection periodically
            setInterval(updateFaucetUI, 1000);
            updateFaucetUI();
        });
    </script>
</body>
</html>
